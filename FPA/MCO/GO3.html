<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Gestion des Approvisionnements - BTS MCO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; background-color: #FDFBF8; color: #3f3f46; }
        .tab-active { border-color: #4f46e5; color: #4f46e5; background-color: #eef2ff; }
        .tab-inactive { border-color: transparent; color: #71717a; }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .card { background-color: #ffffff; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); padding: 1.5rem; }
        .chart-container { position: relative; width: 100%; max-width: 800px; margin: auto; height: 40vh; max-height: 450px; }
        .calculator-input, .sim-input { width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #d4d4d8; border-radius: 0.375rem; transition: border-color 0.2s; }
        .calculator-input:focus, .sim-input:focus { outline: none; border-color: #4f46e5; }
        .accordion-item { border-bottom: 1px solid #e5e7eb; }
        .accordion-button { width: 100%; text-align: left; padding: 1rem; font-weight: 500; color: #374151; display: flex; justify-content: space-between; align-items: center; background-color: #f9fafb; border: none; cursor: pointer; }
        .accordion-button:hover { background-color: #f3f4f6; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; padding: 0 1rem; background-color: white; }
        .accordion-content .content-inner { padding: 1rem 0; }
        .accordion-icon { transition: transform 0.3s ease; }
        .accordion-button.active .accordion-icon { transform: rotate(180deg); }
        .formula-box { background-color: #f3f4f6; padding: 1rem; border-radius: 0.5rem; border-left: 4px solid #4f46e5; font-family: monospace; color: #1f2937; margin: 1rem 0; text-align: center; }
        .sim-button { padding: 0.5rem 1rem; border-radius: 0.375rem; font-weight: 500; transition: background-color 0.2s; }
        .sim-button:disabled { background-color: #d1d5db; cursor: not-allowed; }
        .tooltip-container { position: relative; display: inline-flex; align-items: center; cursor: pointer; }
        .tooltip-icon { font-size: 0.75rem; background-color: #4f46e5; color: #ffffff; border-radius: 9999px; width: 1.25rem; height: 1.25rem; display: flex; justify-content: center; align-items: center; margin-left: 0.35rem; font-weight: bold; }
        .tooltip-text { visibility: hidden; width: 220px; background-color: #1f2937; color: #fff; text-align: center; border-radius: 6px; padding: 8px; position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -110px; opacity: 0; transition: opacity 0.3s; font-size: 0.8rem; }
        .tooltip-container:hover .tooltip-text { visibility: visible; opacity: 1; }
        .mission-box { background-color: #eef2ff; border-left: 4px solid #4f46e5; padding: 1rem; margin-bottom: 1rem; border-radius: 0 0.5rem 0.5rem 0; }
        .analysis-box { background-color: #f0fdf4; border: 1px solid #bbf7d0; padding: 1rem; margin-top: 1.5rem; border-radius: 0.5rem; text-align: center; }
        .stock-level-diagram div { border-left: 4px solid; padding-left: 1rem; margin-bottom: 1rem; cursor: pointer; }
        .progress-bar-container { width: 100%; background-color: #e5e7eb; border-radius: 9999px; height: 1rem; }
        .progress-bar { background-color: #4f46e5; height: 1rem; border-radius: 9999px; transition: width 0.5s ease-in-out; }
        .quiz-option { display: block; width: 100%; text-align: left; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; margin-bottom: 0.5rem; transition: all 0.2s; }
        .quiz-option:hover { border-color: #4f46e5; background-color: #eef2ff; }
        .quiz-option.correct { background-color: #dcfce7; border-color: #22c55e; }
        .quiz-option.incorrect { background-color: #fee2e2; border-color: #ef4444; }
        .quiz-option:disabled { opacity: 0.7; cursor: not-allowed; }
        .feedback-box { padding: 1rem; margin-top: 1rem; border-radius: 0.5rem; }
        .feedback-box.correct { background-color: #f0fdf4; border-left: 4px solid #22c55e; }
        .feedback-box.incorrect { background-color: #fef2f2; border-left: 4px solid #ef4444; }
        .prose ul { list-style-type: disc; padding-left: 1.5rem; }
        .prose ol { list-style-type: decimal; padding-left: 1.5rem; }
        .prose li { margin-bottom: 0.5rem; }
    </style>
</head>
<body class="antialiased">

    <div id="top" class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800">Gestion des Approvisionnements</h1>
            <p class="text-lg text-gray-600 mt-2">Un outil interactif pour les √©tudiants en BTS MCO</p>
        </header>

        <div class="mb-8 relative">
             <!-- Burger Menu Button -->
            <button id="burger-btn" class="md:hidden absolute top-0 right-0 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 z-20">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
            <div class="border-b border-gray-200">
                <!-- Desktop Navigation -->
                <nav class="hidden md:flex -mb-px flex-wrap justify-center gap-x-2 sm:gap-x-4" aria-label="Tabs">
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-active" data-tab="introduction">Introduction</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-inactive" data-tab="fondamentaux">Les Fondamentaux</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-inactive" data-tab="reguliere">Demande R√©guli√®re</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-inactive" data-tab="irreguliere">Demande Irr√©guli√®re</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-inactive" data-tab="niveaux">Niveaux de Stock</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-inactive" data-tab="arbitrage">Arbitrage</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-inactive" data-tab="synthese">Synth√®se</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-inactive" data-tab="lexique">Lexique</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-inactive" data-tab="faq">FAQ</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-3 sm:px-4 border-b-2 font-medium text-sm sm:text-base tab-inactive" data-tab="quiz">Quiz</button>
                </nav>
            </div>
             <!-- Mobile Navigation Menu -->
            <nav id="mobile-menu" class="hidden md:hidden absolute top-full right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border">
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="introduction">Introduction</button>
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="fondamentaux">Les Fondamentaux</button>
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="reguliere">Demande R√©guli√®re</button>
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="irreguliere">Demande Irr√©guli√®re</button>
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="niveaux">Niveaux de Stock</button>
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="arbitrage">Arbitrage</button>
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="synthese">Synth√®se</button>
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="lexique">Lexique</button>
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="faq">FAQ</button>
                <button class="tab-btn block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-tab="quiz">Quiz</button>
            </nav>
        </div>

        <main>
            <section id="introduction" class="content-section active">
                <div class="card">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Introduction Vid√©o</h2>
                    <p class="mb-6 text-gray-600">Pour bien commencer, cette vid√©o pr√©sente les concepts fondamentaux de la gestion des approvisionnements, leur importance et leur application dans le cadre du MCO.</p>
                    <div style="position: relative; width: 100%; height: 0; padding-top: 56.2500%;
                     padding-bottom: 0; box-shadow: 0 2px 8px 0 rgba(63,69,81,0.16); margin-top: 1.6em; margin-bottom: 0.9em; overflow: hidden;
                     border-radius: 8px; will-change: transform;">
                      <iframe loading="lazy" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; border: none; padding: 0;margin: 0;"
                        src="https://www.canva.com/design/DAGzhAP0nGw/QEFhuab5wAwZmJ8UtEQE2Q/watch?embed" allowfullscreen="allowfullscreen" allow="fullscreen">
                      </iframe>
                    </div>
                </div>
            </section>

            <section id="fondamentaux" class="content-section">
                <div class="card text-center">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Le Dilemme du Manager : Trouver l'√âquilibre</h2>
                    <div class="max-w-3xl mx-auto text-gray-600 mb-4 text-left bg-gray-50 p-4 rounded-lg border">
                        <p>Vous √™tes le manager de l'√©picerie Avicenne. Pour votre produit phare, la farine, vous faites face √† un dilemme classique. Votre objectif : trouver le nombre de commandes annuelles id√©al pour minimiser vos frais de gestion.</p>
                        <p class="mt-2"><strong>Vos donn√©es :</strong> Consommation annuelle : <strong>1 200 000 ‚Ç¨</strong> | Co√ªt de passation d'une commande : <strong>150 ‚Ç¨</strong> | Taux de possession du stock : <strong>15%</strong>.</p>
                        <p class="mt-2 text-indigo-600 font-medium">Observez comment le <strong>stock moyen</strong> √©volue et impacte directement vos co√ªts.</p>
                    </div>
                    <div class="chart-container mb-6"><canvas id="costsChart"></canvas></div>
                    <div class="max-w-md mx-auto">
                        <label for="orderCountSlider" class="block text-sm font-medium text-gray-700 mb-2">Faites varier le nombre de commandes : <span id="sliderValue" class="font-bold text-indigo-600"></span></label>
                        <input id="orderCountSlider" type="range" min="1" max="25" value="12" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>
                    <div class="mt-6 grid grid-cols-2 sm:grid-cols-4 gap-4 text-center">
                        <div><p class="text-sm text-gray-500">Stock Moyen</p><p id="averageStock" class="text-xl font-semibold text-green-600"></p></div>
                        <div><p class="text-sm text-gray-500">Co√ªt de Possession (Stockage)</p><p id="possessionCost" class="text-xl font-semibold text-blue-600"></p></div>
                        <div><p class="text-sm text-gray-500">Co√ªt de Passation (Commande)</p><p id="orderingCost" class="text-xl font-semibold text-red-600"></p></div>
                        <div><p class="text-sm text-gray-500">Co√ªt Total de Gestion</p><p id="totalCost" class="text-xl font-bold text-gray-800"></p></div>
                    </div>
                    <div class="mt-8 pt-6 border-t">
                        <h3 class="text-lg font-medium text-gray-900">Comment √ßa marche ? Les formules derri√®re le simulateur</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4 text-sm">
                            <div class="bg-gray-50 p-4 rounded-lg"><p class="font-semibold">Stock Moyen (‚Ç¨)</p><p class="text-gray-600">Conso. Annuelle / (2 x Nb Commandes)</p></div>
                            <div class="bg-blue-50 p-4 rounded-lg"><p class="font-semibold">Co√ªt de Possession (‚Ç¨)</p><p class="text-gray-600">Stock Moyen x Taux de Possession</p></div>
                            <div class="bg-red-50 p-4 rounded-lg"><p class="font-semibold">Co√ªt de Passation (‚Ç¨)</p><p class="text-gray-600">Nb Commandes x Co√ªt d'une Commande</p></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="reguliere" class="content-section">
                 <div class="card">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800 text-center">Mini-Cas : Optimisation chez Avicenne</h2>
                    <p class="max-w-3xl mx-auto text-gray-600 mb-8 text-center">Suivez le raisonnement complet d'un manager pour optimiser les commandes de farine, dont la demande est stable.</p>
                    <div class="border rounded-lg p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">√âtape 1 : Calcul du Taux de Possession</h3>
                        <p class="text-sm text-gray-600 mb-4">Avant d'optimiser, il faut conna√Ætre les co√ªts. Aidez le manager √† calculer le co√ªt r√©el de son stock de farine.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="space-y-3"><p class="font-medium text-gray-700">A. Co√ªts de possession annuels (‚Ç¨)</p><div><label for="costLoyer" class="text-sm">Loyer de l'entrep√¥t</label><input type="number" id="costLoyer" value="45000" class="calculator-input mt-1"></div><div><label for="costSalaires" class="text-sm">Salaires du personnel</label><input type="number" id="costSalaires" value="30000" class="calculator-input mt-1"></div><div><label for="costAssurances" class="text-sm">Assurances & divers</label><input type="number" id="costAssurances" value="15000" class="calculator-input mt-1"></div></div><div class="space-y-3"><p class="font-medium text-gray-700">B. Stock moyen en valeur (‚Ç¨)</p><div><label for="stockMoyen" class="text-sm">Valeur moyenne du stock de farine</label><input type="number" id="stockMoyen" value="600000" class="calculator-input mt-1"></div><div class="mt-6 pt-6 border-t"><p class="font-medium text-gray-700">C. Calcul du Taux (%)</p><p class="text-xs text-gray-500 mb-2">Formule : (Total Co√ªts A / Stock Moyen B) * 100</p><div class="bg-indigo-50 p-4 rounded-lg text-center"><p class="text-sm text-gray-600">Taux de Possession Calcul√©</p><p id="calculatedRate" class="text-2xl font-bold text-indigo-700">15 %</p></div></div></div></div>
                        <div class="text-center mt-6"><button id="useCalculatedRate" class="bg-indigo-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-indigo-700 transition">Utiliser ce taux pour l'√âtape 2 &#8595;</button></div>
                    </div>
                    <div class="border rounded-lg p-6 mt-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">√âtape 2 : Application de la Formule de Wilson</h3>
                        <p class="text-sm text-gray-600 mb-4">Maintenant que le taux est connu, utilisez la formule de Wilson pour trouver le nombre de commandes id√©al.</p>
                        <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md my-4" role="alert"><p><strong>Rappel :</strong> Ce mod√®le n'est valable que pour une demande stable et pr√©visible.</p></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start"><div class="space-y-4"><div><label for="consommation" class="block text-sm font-medium text-gray-700">Consommation annuelle de farine (‚Ç¨)</label><input type="number" id="consommation" value="1200000" class="calculator-input mt-1"></div><div><label for="tauxPossession" class="flex items-center text-sm font-medium text-gray-700">Taux de possession du stock (%)</label><input type="number" id="tauxPossession" value="15" class="calculator-input mt-1 bg-gray-100" readonly></div><div><label for="coutPassation" class="block text-sm font-medium text-gray-700">Co√ªt de passation d'une commande (‚Ç¨)</label><input type="number" id="coutPassation" value="150" class="calculator-input mt-1"></div><button id="calculateWilson" class="w-full bg-gray-700 text-white font-semibold py-2 px-4 rounded-md hover:bg-gray-800 transition">Calculer l'optimum</button></div><div class="bg-gray-50 p-6 rounded-lg"><h4 class="text-lg font-medium text-gray-900 mb-4">R√©sultats Optimaux</h4><div class="space-y-3"><div><p class="text-sm text-gray-600">Nombre optimal de commandes (N)</p><p id="wilsonN" class="text-2xl font-bold text-gray-800">-</p></div><div><p class="text-sm text-gray-600">Co√ªt de gestion minimum</p><p id="wilsonCost" class="text-2xl font-bold text-gray-800">-</p></div><div><p class="text-sm text-gray-600">Fr√©quence des commandes</p><p id="wilsonFreq" class="text-lg font-semibold text-gray-800">-</p></div></div></div></div>
                    </div>
                </div>
            </section>
            
            <section id="irreguliere" class="content-section">
                 <div class="card"><h2 class="text-2xl font-semibold mb-4 text-gray-800 text-center">Gestion pour une Demande Irr√©guli√®re</h2><p class="max-w-3xl mx-auto text-gray-600 mb-8 text-center">Quand la demande varie, il faut des m√©thodes flexibles. Exp√©rimentez "pas √† pas" les deux approches principales pour comprendre leur logique de d√©clenchement.</p><div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><div class="bg-gray-50 p-6 rounded-lg"><h3 class="text-xl font-semibold text-center mb-2 text-gray-800">M√©thode du Point de Commande</h3><div class="mission-box text-sm"><p>üéØ <strong>Votre Mission :</strong> Observez comment le stock est le seul patron ! La commande se d√©clenche *uniquement* lorsque le stock final passe sous le 'stock d'alerte'.</p></div><div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div><label for="pdcStockInitial">Stock initial</label><input type="number" id="pdcStockInitial" value="60" class="sim-input mt-1"></div><div><label for="pdcStockAlerte" class="flex items-center">Stock d'alerte<div class="tooltip-container"><span class="tooltip-icon">i</span><span class="tooltip-text">C'est le seuil qui d√©clenche l'alarme. Essayez avec 40 puis 15 et voyez comme la date de commande change !</span></div></label><input type="number" id="pdcStockAlerte" value="25" class="sim-input mt-1"></div><div><label for="pdcQteCmd">Qt√© command√©e</label><input type="number" id="pdcQteCmd" value="50" class="sim-input mt-1"></div><div><label for="pdcDelai">D√©lai livraison (j)</label><input type="number" id="pdcDelai" value="2" class="sim-input mt-1"></div><div class="col-span-2"><label for="pdcVentes">Ventes journali√®res</label><input type="text" id="pdcVentes" value="10, 12, 8, 15, 11, 9, 13" class="sim-input mt-1"></div></div><div class="flex justify-center gap-4 mb-4"><button id="pdcNextDay" class="sim-button bg-indigo-600 text-white">Jour Suivant</button><button id="pdcReset" class="sim-button bg-gray-300 text-gray-800">R√©initialiser</button></div><div class="overflow-x-auto"><table class="min-w-full text-sm"><thead class="text-xs uppercase bg-gray-200"><tr><th class="px-2 py-2">Jour</th><th class="px-2 py-2">Stock D√©but</th><th class="px-2 py-2">Vente</th><th class="px-2 py-2">Stock Fin</th><th class="px-2 py-2">Action</th></tr></thead><tbody id="pdcTableBody"></tbody></table></div></div><div class="bg-gray-50 p-6 rounded-lg"><h3 class="text-xl font-semibold text-center mb-2 text-gray-800">M√©thode de la Gestion Calendaire</h3><div class="mission-box text-sm"><p>üéØ <strong>Votre Mission :</strong> Remarquez que la date est reine ! La commande a toujours lieu au 'jour de commande' pr√©vu. Concentrez-vous sur la quantit√© command√©e, qui, elle, s'adapte.</p></div><div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div><label for="calStockInitial">Stock initial</label><input type="number" id="calStockInitial" value="70" class="sim-input mt-1"></div><div><label for="calStockSecu" class="flex items-center">Stock s√©curit√©<div class="tooltip-container"><span class="tooltip-icon">i</span><span class="tooltip-text">C'est votre matelas de s√©curit√©. Il est ajout√© au calcul du besoin pour s'assurer de ne jamais tomber √† z√©ro.</span></div></label><input type="number" id="calStockSecu" value="10" class="sim-input mt-1"></div><div><label for="calJourCmd" class="flex items-center">Jour de commande<div class="tooltip-container"><span class="tooltip-icon">i</span><span class="tooltip-text">Le calendrier d√©cide. Changez cette valeur et voyez comment la simulation attend toujours ce jour pr√©cis pour commander.</span></div></label><input type="number" id="calJourCmd" value="5" class="sim-input mt-1"></div><div><label for="calDelai">D√©lai livraison (j)</label><input type="number" id="calDelai" value="2" class="sim-input mt-1"></div><div class="col-span-2"><label for="calVentes">Ventes journali√®res</label><input type="text" id="calVentes" value="10, 12, 8, 15, 11, 9, 13, 10, 14" class="sim-input mt-1"></div></div><div class="flex justify-center gap-4 mb-4"><button id="calNextDay" class="sim-button bg-indigo-600 text-white">Jour Suivant</button><button id="calReset" class="sim-button bg-gray-300 text-gray-800">R√©initialiser</button></div><div class="overflow-x-auto"><table class="min-w-full text-sm"><thead class="text-xs uppercase bg-gray-200"><tr><th class="px-2 py-2">Jour</th><th class="px-2 py-2">Stock D√©but</th><th class="px-2 py-2">Vente</th><th class="px-2 py-2">Stock Fin</th><th class="px-2 py-2">Action</th></tr></thead><tbody id="calTableBody"></tbody></table></div></div></div></div>
            </section>
            
            <section id="niveaux" class="content-section">
                <div class="card"><h2 class="text-2xl font-semibold mb-4 text-gray-800 text-center">Comprendre les Niveaux de Stock Strat√©giques</h2><p class="max-w-3xl mx-auto text-gray-600 mb-8 text-center">Un manager d√©finit plusieurs niveaux de stock cl√©s pour s√©curiser ses approvisionnements. Survolez chaque niveau pour voir sa d√©finition et sa formule de calcul.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center"><div class="stock-level-diagram"><div style="border-color: #ef4444;" data-level="alerte"><h4 class="font-bold text-lg">Stock d'Alerte</h4><p class="text-sm text-gray-500">Niveau qui d√©clenche la commande.</p></div><div style="border-color: #f97316;" data-level="securite"><h4 class="font-bold text-lg">Stock de S√©curit√©</h4><p class="text-sm text-gray-500">Marge pour parer aux impr√©vus.</p></div><div style="border-color: #eab308;" data-level="minimum"><h4 class="font-bold text-lg">Stock Minimum</h4><p class="text-sm text-gray-500">Stock pour couvrir les ventes durant la livraison.</p></div></div><div id="stockLevelExplanation" class="bg-gray-50 p-6 rounded-lg min-h-[200px] flex items-center justify-center"><p class="text-gray-500 text-center">Survolez un niveau de stock pour voir les d√©tails.</p></div></div></div>
            </section>
            
            <section id="arbitrage" class="content-section">
                <div class="card"><h2 class="text-2xl font-semibold mb-4 text-gray-800 text-center">Arbitrage Manag√©rial par les Co√ªts</h2><div class="mission-box text-sm text-center"><p><strong>Contexte Manag√©rial :</strong> Vous √™tes le manager. La demande est irr√©guli√®re, la formule de Wilson est donc inutile. Votre seule arme est de simuler les co√ªts pour diff√©rents sc√©narios afin de prendre la d√©cision la plus rationnelle et la moins co√ªteuse.</p></div><div class="grid grid-cols-1 md:grid-cols-3 gap-6 my-8"><div><label for="arbBesoin" class="flex items-center text-sm font-medium">Besoin total en valeur (‚Ç¨)<div class="tooltip-container"><span class="tooltip-icon">i</span><span class="tooltip-text">C'est la quantit√© totale que vous devez acheter sur la p√©riode (ex: les ventes du mois prochain estim√©es).</span></div></label><input type="number" id="arbBesoin" value="10000" class="calculator-input mt-1"></div><div><label for="arbTaux" class="flex items-center text-sm font-medium">Taux de possession (%)<div class="tooltip-container"><span class="tooltip-icon">i</span><span class="tooltip-text">Formule : Co√ªt de Possession (‚Ç¨) / Stock Moyen en Valeur (‚Ç¨). Ce taux repr√©sente le co√ªt annuel pour stocker 1‚Ç¨ de marchandise.</span></div></label><input type="number" id="arbTaux" value="15" class="calculator-input mt-1"></div><div><label for="arbCout" class="flex items-center text-sm font-medium">Co√ªt de passation (‚Ç¨)<div class="tooltip-container"><span class="tooltip-icon">i</span><span class="tooltip-text">Chaque commande que vous passez vous co√ªte cette somme (frais admin, livraison...). Plus vous commandez, plus ce co√ªt augmente.</span></div></label><input type="number" id="arbCout" value="50" class="calculator-input mt-1"></div></div><div class="text-center mb-8"><button id="calculateArbitrage" class="bg-indigo-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-indigo-700 transition">Lancer la simulation</button></div><div class="overflow-x-auto"><table class="min-w-full text-sm text-left"><thead class="text-xs text-gray-700 uppercase bg-gray-50"><tr><th class="px-4 py-2">Nb Commandes</th><th class="px-4 py-2">Co√ªt Possession</th><th class="px-4 py-2">Co√ªt Passation</th><th class="px-4 py-2 font-bold">Co√ªt Total</th></tr></thead><tbody id="arbitrageTable"></tbody></table></div><div id="analysisResult" class="analysis-box" style="display: none;"></div></div>
            </section>

            <section id="synthese" class="content-section">
                <div class="card">
                    <h2 class="text-2xl font-semibold mb-2 text-gray-800">Synth√®se - Carte Mentale</h2>
                    <p class="mb-6 text-gray-600">Cette carte mentale interactive r√©sume les points essentiels de la gestion des approvisionnements. Naviguez √† travers les diff√©rentes branches pour r√©viser les d√©finitions, les formules et les liens entre les concepts.</p>
                    <div class="w-full h-[750px] border border-gray-200 rounded-lg overflow-hidden">
                         <iframe src='https://www.xmind.app/embed/PBT9X6/' width="100%" height="100%" frameborder='0' scrolling='no' allowfullscreen="true"></iframe>
                    </div>
                </div>
            </section>

            <section id="lexique" class="content-section">
                <div class="card"><h2 class="text-2xl font-semibold mb-4 text-gray-800 text-center">Lexique des Termes Cl√©s</h2><p class="max-w-3xl mx-auto text-gray-600 mb-8 text-center">Ma√Ætrisez le vocabulaire essentiel. Cliquez sur chaque terme pour afficher sa d√©finition.</p><div id="accordion-lexique" class="space-y-2"><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>Co√ªt de gestion des approvisionnements</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>Somme du co√ªt de passation des commandes et du co√ªt de possession du stock. L'objectif du gestionnaire est de trouver le point d'√©quilibre o√π cette somme est la plus faible possible.</p></div></div></div><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>Co√ªt de passation d'une commande (ou Co√ªt de lancement)</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>Ensemble des charges administratives et logistiques g√©n√©r√©es par le processus d'achat lui-m√™me (salaires, fournitures, transport, r√©ception). Ce co√ªt est proportionnel au nombre de commandes pass√©es.</p></div></div></div><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>Co√ªt de possession du stock (ou Co√ªt de stockage)</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>Ensemble des d√©penses engag√©es pour d√©tenir physiquement et financi√®rement des marchandises (loyer de l'entrep√¥t, personnel, assurances, co√ªt du capital immobilis√©, risques d'obsolescence). Ce co√ªt est proportionnel au volume de stock moyen d√©tenu.</p></div></div></div><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>Formule de Wilson (ou EOQ - Economic Order Quantity)</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>Outil math√©matique permettant de d√©terminer le nombre optimal de commandes (et la quantit√© par commande) qui minimise le co√ªt total de gestion du stock. Elle n'est applicable que pour des produits dont la demande est certaine, constante et r√©guli√®re.</p></div></div></div><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>Gestion calendaire</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>M√©thode d'approvisionnement pour demande irr√©guli√®re, bas√©e sur le principe "Date Fixe, Quantit√© Variable". Les commandes sont pass√©es √† intervalles r√©guliers, mais la quantit√© command√©e est ajust√©e pour couvrir les besoins jusqu'√† la prochaine livraison. Pertinente quand le fournisseur impose des jours de livraison.</p></div></div></div><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>M√©thode du point de commande</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>M√©thode d'approvisionnement pour demande irr√©guli√®re, bas√©e sur le principe "Quantit√© Fixe, Date Variable". Une commande d'une quantit√© pr√©d√©finie est d√©clench√©e chaque fois que le stock atteint un seuil critique (le stock d'alerte). Pertinente quand le fournisseur impose des quantit√©s de commande.</p></div></div></div><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>Rupture de stock</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>Incapacit√© √† satisfaire la demande d'un client car le produit est indisponible. C'est un √©chec op√©rationnel aux cons√©quences graves : perte de chiffre d'affaires (co√ªt direct), perte de clients et d√©gradation de l'image de marque (co√ªts indirects).</p></div></div></div><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>Stock d'alerte (ou Point de commande)</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>Niveau de stock qui agit comme un signal op√©rationnel : une fois atteint, il d√©clenche l'action de passer une nouvelle commande. Il est calcul√© pour que la livraison arrive avant que l'entreprise n'ait besoin de consommer son stock de s√©curit√©. Formule : Stock d'Alerte = Stock Minimum + Stock de S√©curit√©.</p></div></div></div><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>Stock de s√©curit√©</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>Stock additionnel, conserv√© en plus du stock minimum, pour se pr√©munir contre les al√©as et l'incertitude (retard de livraison, pic de ventes). C'est un tampon contre l'impr√©vu qui mat√©rialise le niveau de service client souhait√©.</p></div></div></div><div class="accordion-item rounded-lg overflow-hidden shadow-sm"><button class="accordion-button"><span>Stock minimum</span><span class="accordion-icon">&#9660;</span></button><div class="accordion-content"><div class="content-inner prose max-w-none"><p>Niveau de stock th√©orique n√©cessaire pour couvrir la consommation moyenne pendant le d√©lai de livraison normal d'un fournisseur. Il assure la continuit√© des ventes durant un cycle de r√©approvisionnement standard.</p></div></div></div></div></div>
            </section>

            <section id="faq" class="content-section">
                <div class="card">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-800 text-center">Foire Aux Questions (FAQ)</h2>
                    <p class="max-w-3xl mx-auto text-gray-600 mb-8 text-center">Les r√©ponses claires aux questions les plus fr√©quentes des gestionnaires d√©butants.</p>
                    <div id="accordion-faq" class="space-y-2">
                        <div class="accordion-item rounded-lg overflow-hidden shadow-sm">
                            <button class="accordion-button"><span>Quel est le dilemme fondamental de la gestion des approvisionnements ?</span><span class="accordion-icon">&#9660;</span></button>
                            <div class="accordion-content">
                                <div class="content-inner prose max-w-none">
                                    <p>Il s'agit d'un arbitrage constant entre deux strat√©gies extr√™mes :</p>
                                    <ul>
                                        <li><strong>Commander en grande quantit√© et peu souvent :</strong> Cette approche r√©duit au minimum les frais de passation de commandes (moins de frais administratifs, moins de livraisons). Cependant, elle fait exploser les co√ªts de possession du stock, car elle n√©cessite un grand espace de stockage et immobilise une part importante de la tr√©sorerie.</li>
                                        <li><strong>Commander en petite quantit√© et tr√®s souvent :</strong> Cette approche r√©duit les co√ªts de possession (moins de stock, moins de capital immobilis√©). En revanche, elle multiplie les frais administratifs et les co√ªts de transport li√©s √† la fr√©quence √©lev√©e des commandes.</li>
                                    </ul>
                                    <p>L'optimisation consiste √† trouver le point d'√©quilibre parfait entre ces deux extr√™mes, celui o√π le co√ªt total (passation + possession) est le plus bas possible.</p>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item rounded-lg overflow-hidden shadow-sm">
                            <button class="accordion-button"><span>Pourquoi ne pas simplement commander en tr√®s grande quantit√© pour ne jamais √™tre en rupture de stock ?</span><span class="accordion-icon">&#9660;</span></button>
                            <div class="accordion-content">
                                <div class="content-inner prose max-w-none">
                                    <p>Si cette strat√©gie semble s√©curisante car elle √©limine le risque de p√©nurie, elle g√©n√®re en r√©alit√© des contraintes et des co√ªts qui sont souvent prohibitifs et contre-productifs :</p>
                                    <ul>
                                        <li><strong>Contraintes Physiques :</strong> Avoir beaucoup de stock n√©cessite un espace de stockage important, ce qui a un co√ªt direct (loyer, am√©nagement).</li>
                                        <li><strong>Contraintes Financi√®res :</strong> C'est la contrainte la plus forte. Un stock volumineux immobilise une part importante de la tr√©sorerie de l'entreprise qui ne peut √™tre utilis√©e pour d'autres investissements. De plus, il g√©n√®re un co√ªt de possession tr√®s √©lev√© (assurances, personnel, etc.).</li>
                                        <li><strong>Contraintes Commerciales :</strong> Cette strat√©gie augmente au maximum le risque d'invendus, de p√©remption (pour les produits p√©rissables) ou d'obsolescence (pour les produits technologiques ou de mode).</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item rounded-lg overflow-hidden shadow-sm">
                            <button class="accordion-button"><span>Dans quel cas pr√©cis doit-on utiliser la formule de Wilson ?</span><span class="accordion-icon">&#9660;</span></button>
                            <div class="accordion-content">
                                <div class="content-inner prose max-w-none">
                                    <p>La formule de Wilson est un outil d'optimisation puissant, mais elle ne doit √™tre utilis√©e que lorsque la demande pour un produit est connue, certaine et r√©guli√®re dans le temps. Si la demande est volatile, saisonni√®re ou impr√©visible, les hypoth√®ses du mod√®le ne sont plus valides. Tenter de l'appliquer dans un tel contexte m√®nerait in√©vitablement √† des ruptures de stock ou √† du surstockage. C'est pr√©cis√©ment pour g√©rer ces situations d'incertitude que d'autres m√©thodes existent.</p>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item rounded-lg overflow-hidden shadow-sm">
                            <button class="accordion-button"><span>Que faire si la demande pour mon produit est impr√©visible et irr√©guli√®re ?</span><span class="accordion-icon">&#9660;</span></button>
                            <div class="accordion-content">
                                <div class="content-inner prose max-w-none">
                                    <p>Dans ce contexte, l'objectif principal n'est plus de trouver un optimum math√©matique, mais de garantir la disponibilit√© du produit et d'√©viter √† tout prix la rupture de stock. Contrairement au Mod√®le de Wilson qui recherche un optimum √©conomique dans un monde pr√©visible, ces m√©thodes sont des strat√©gies de gestion du risque dans un environnement incertain. Le choix de la m√©thode est alors souvent contraint par votre fournisseur :</p>
                                    <ul>
                                        <li>La <strong>m√©thode du point de commande</strong> est √† utiliser si votre fournisseur vous impose des quantit√©s de commande fixes (par exemple, par cartons complets).</li>
                                        <li>La <strong>m√©thode de gestion calendaire</strong> est √† utiliser si votre fournisseur vous impose des dates de livraison fixes (par exemple, une tourn√©e de livraison chaque mardi).</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item rounded-lg overflow-hidden shadow-sm">
                            <button class="accordion-button"><span>Qu'est-ce qu'une rupture de stock et pourquoi est-ce si grave ?</span><span class="accordion-icon">&#9660;</span></button>
                            <div class="accordion-content">
                                <div class="content-inner prose max-w-none">
                                    <p>La rupture de stock est l'incapacit√© √† satisfaire la demande d'un client car le produit qu'il souhaite acheter est indisponible. Il s'agit d'un √©chec op√©rationnel majeur qui d√©clenche une v√©ritable boucle de r√©troaction n√©gative. Ses cons√©quences d√©passent largement la simple vente manqu√©e :</p>
                                    <ul>
                                        <li><strong>Co√ªts directs :</strong> C'est la perte imm√©diate du chiffre d'affaires et de la marge sur la vente qui n'a pas pu √™tre r√©alis√©e.</li>
                                        <li><strong>Co√ªts indirects (souvent plus graves) :</strong>
                                            <ul>
                                                <li><strong>Perte du client :</strong> Un client frustr√© se tournera vers un concurrent et risque de ne jamais revenir.</li>
                                                <li><strong>D√©gradation de l'image de marque :</strong> Des ruptures fr√©quentes, relay√©es par des avis n√©gatifs, nuisent √† votre r√©putation de fiabilit√© et affectent les ventes futures.</li>
                                                <li><strong>D√©sorganisation op√©rationnelle :</strong> La gestion de l'urgence (commandes express, gestion des plaintes) engendre des co√ªts suppl√©mentaires et perturbe les √©quipes.</li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item rounded-lg overflow-hidden shadow-sm">
                            <button class="accordion-button"><span>Comment les niveaux de stock (minimum, s√©curit√©, alerte) fonctionnent-ils ensemble ?</span><span class="accordion-icon">&#9660;</span></button>
                            <div class="accordion-content">
                                <div class="content-inner prose max-w-none">
                                    <p>Imaginez votre stock comme le r√©servoir de carburant d'une voiture. Ces trois niveaux forment un syst√®me de protection √† plusieurs √©tages, articul√© de mani√®re logique pour ne jamais tomber en panne s√®che (la rupture de stock) :</p>
                                    <ol>
                                        <li>Le <strong>Stock Minimum</strong> est le carburant normal que vous pr√©voyez d'utiliser pour atteindre la prochaine station-service (votre prochaine livraison).</li>
                                        <li>Le <strong>Stock de S√©curit√©</strong> est le r√©servoir de r√©serve. C'est une assurance que vous ne devriez jamais avoir √† utiliser dans des conditions normales.</li>
                                        <li>Le <strong>Stock d'Alerte</strong> est le voyant de carburant sur votre tableau de bord. Il ne s'allume pas quand le r√©servoir est vide, mais quand il vous reste juste assez de carburant (votre Stock Minimum) pour atteindre la prochaine station sans avoir √† toucher √† votre r√©serve (votre Stock de S√©curit√©). En passant commande √† ce niveau pr√©cis, vous vous assurez que la nouvelle livraison arrive pour reconstituer votre stock de roulement, afin que votre stock de s√©curit√© reste intact pour faire face √† une v√©ritable urgence.</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="quiz" class="content-section">
                <div class="card"><div id="quiz-container"><div class="mb-4"><div class="flex justify-between items-center mb-2"><h2 class="text-xl font-semibold text-gray-800">Quiz : Testez vos connaissances</h2><p id="quiz-progress-text" class="text-sm font-medium text-gray-600"></p></div><div class="progress-bar-container"><div id="quiz-progress-bar" class="progress-bar" style="width: 0%;"></div></div></div><div id="quiz-question-area" class="mt-6"><p id="quiz-question" class="text-lg text-gray-700 font-medium mb-4"></p><div id="quiz-options" class="space-y-2"></div><div class="mt-4"><button id="quiz-hint-btn" class="text-sm text-indigo-600 hover:text-indigo-800">üí° Afficher l'indice</button><p id="quiz-hint-text" class="hidden mt-2 text-sm bg-yellow-100 p-3 rounded-md"></p></div><div id="quiz-feedback" class="hidden mt-4"></div><div class="text-right mt-6"><button id="quiz-next-btn" class="hidden bg-indigo-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-indigo-700 transition">Question Suivante</button></div></div></div><div id="quiz-results-area" class="hidden text-center"><h2 class="text-2xl font-bold mb-4">R√©sultats du Quiz</h2><div id="quiz-result-message" class="p-4 rounded-lg mb-6"><p id="quiz-score" class="text-4xl font-bold"></p><p id="quiz-verdict" class="text-lg mt-2"></p></div><h3 class="text-xl font-semibold mb-4">R√©capitulatif de vos r√©ponses</h3><div id="quiz-summary" class="text-left space-y-4"></div><div class="mt-8"><button id="quiz-restart-btn" class="bg-gray-700 text-white font-semibold py-2 px-8 rounded-md hover:bg-gray-800 transition">Recommencer le Quiz</button></div></div></div>
            </section>
        </main>

        <footer class="text-center py-8 mt-12 border-t border-gray-200 text-sm text-gray-500">
            <p>Une application p√©dagogique - MCO.</p>
            <p class="mt-1">¬© 2025-2026 | Tous droits r√©serv√©s.</p>
        </footer>
    </div>
    
    <a href="#top" id="back-to-top-btn" class="fixed bottom-6 right-6 bg-indigo-600 hover:bg-indigo-700 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-opacity duration-300 opacity-0 invisible z-50">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path></svg>
    </a>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Logique de Navigation (Burger + Tabs) ---
            const burgerBtn = document.getElementById('burger-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const allTabs = document.querySelectorAll('.tab-btn');
            const contentSections = document.querySelectorAll('.content-section');

            burgerBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            const switchTab = (clickedTab) => {
                const targetId = clickedTab.dataset.tab;

                allTabs.forEach(t => {
                    const isTarget = t.dataset.tab === targetId;
                    t.classList.toggle('tab-active', isTarget);
                    t.classList.toggle('tab-inactive', !isTarget);
                });

                contentSections.forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(targetId).classList.add('active');

                mobileMenu.classList.add('hidden');
            };

            allTabs.forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab));
            });
            
            // --- Logique des accord√©ons ---
            function setupAccordion(containerId) {
                const accordionContainer = document.getElementById(containerId);
                accordionContainer.querySelectorAll('.accordion-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const content = button.nextElementSibling;
                        button.classList.toggle('active');
                        content.style.maxHeight = content.style.maxHeight ? null : content.scrollHeight + "px";
                    });
                });
            }
            setupAccordion('accordion-lexique');
            setupAccordion('accordion-faq');

            // --- Simulateur: Les Fondamentaux ---
            const slider = document.getElementById('orderCountSlider');
            let costsChart;
            const C_VAL = 1200000, T_VAL = 0.15, P_VAL = 150;
            function updateCosts(numOrders) { 
                const stockMoyen = C_VAL / (2 * numOrders); 
                const coutPossession = stockMoyen * T_VAL; 
                const coutPassation = numOrders * P_VAL; 
                const coutTotal = coutPossession + coutPassation; 
                document.getElementById('sliderValue').textContent = numOrders; 
                document.getElementById('averageStock').textContent = stockMoyen.toFixed(2) + ' ‚Ç¨';
                document.getElementById('possessionCost').textContent = coutPossession.toFixed(2) + ' ‚Ç¨'; 
                document.getElementById('orderingCost').textContent = coutPassation.toFixed(2) + ' ‚Ç¨'; 
                document.getElementById('totalCost').textContent = coutTotal.toFixed(2) + ' ‚Ç¨'; 
                return { coutTotal }; 
            }
            function createOrUpdateChart() { const labels = Array.from({ length: 25 }, (_, i) => i + 1); const possessionData = labels.map(n => (C_VAL / (2 * n)) * T_VAL); const orderingData = labels.map(n => n * P_VAL); const totalData = labels.map((n, i) => possessionData[i] + orderingData[i]); const ctx = document.getElementById('costsChart').getContext('2d'); if (costsChart) { costsChart.destroy(); } costsChart = new Chart(ctx, { type: 'line', data: { labels: labels, datasets: [{ label: 'Co√ªt de Possession', data: possessionData, borderColor: 'rgb(59, 130, 246)', tension: 0.1 }, { label: 'Co√ªt de Passation', data: orderingData, borderColor: 'rgb(239, 68, 68)', tension: 0.1 }, { label: 'Co√ªt Total', data: totalData, borderColor: 'rgb(31, 41, 55)', borderWidth: 3, tension: 0.1 }, { type: 'scatter', label: 'Point Actuel', data: [], backgroundColor: 'rgb(79, 70, 229)', pointRadius: 6 }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true } } } }); updateChartPoint(parseInt(slider.value)); }
            function updateChartPoint(numOrders) { const costs = updateCosts(numOrders); if (costsChart) { costsChart.data.datasets[3].data = [{ x: numOrders, y: costs.coutTotal }]; costsChart.update(); } }
            slider.addEventListener('input', (e) => updateChartPoint(parseInt(e.target.value)));
            
            document.querySelector('[data-tab="fondamentaux"]').addEventListener('click', () => {
                setTimeout(() => {
                    if (!costsChart) {
                        createOrUpdateChart();
                    }
                }, 50);
            });


             // --- Mini-cas: Demande R√©guli√®re ---
            const costInputs = [document.getElementById('costLoyer'), document.getElementById('costSalaires'), document.getElementById('costAssurances'), document.getElementById('stockMoyen')];
            const calculatedRateEl = document.getElementById('calculatedRate');
            const tauxPossessionEl = document.getElementById('tauxPossession');
            function calculateRate() { const costLoyer = parseFloat(document.getElementById('costLoyer').value) || 0; const costSalaires = parseFloat(document.getElementById('costSalaires').value) || 0; const costAssurances = parseFloat(document.getElementById('costAssurances').value) || 0; const stockMoyen = parseFloat(document.getElementById('stockMoyen').value) || 0; const totalCosts = costLoyer + costSalaires + costAssurances; const rate = stockMoyen > 0 ? (totalCosts / stockMoyen) * 100 : 0; calculatedRateEl.textContent = rate.toFixed(2) + ' %'; }
            costInputs.forEach(input => input.addEventListener('input', calculateRate));
            document.getElementById('useCalculatedRate').addEventListener('click', () => { const rateValue = parseFloat(calculatedRateEl.textContent); if (!isNaN(rateValue)) { tauxPossessionEl.value = rateValue.toFixed(2); document.getElementById('calculateWilson').click(); tauxPossessionEl.scrollIntoView({ behavior: 'smooth', block: 'center' }); } });
            document.getElementById('calculateWilson').addEventListener('click', () => { const C = parseFloat(document.getElementById('consommation').value), T = parseFloat(tauxPossessionEl.value) / 100, P = parseFloat(document.getElementById('coutPassation').value); if (isNaN(C) || isNaN(T) || isNaN(P) || C <= 0 || T < 0 || P <= 0) { document.getElementById('wilsonN').textContent = '-'; document.getElementById('wilsonCost').textContent = '-'; document.getElementById('wilsonFreq').textContent = '-'; return; }; const minCost = Math.sqrt(2 * C * T * P); const N = minCost / P; document.getElementById('wilsonN').textContent = N.toFixed(2); document.getElementById('wilsonCost').textContent = minCost.toFixed(2) + ' ‚Ç¨'; document.getElementById('wilsonFreq').textContent = `Environ tous les ${(365 / N).toFixed(0)} jours`; });
            calculateRate();

            // --- Logique: Niveaux de Stock ---
            const stockLevels = document.querySelectorAll('.stock-level-diagram div');
            const explanationBox = document.getElementById('stockLevelExplanation');
            const explanations = { 
                minimum: { 
                    title: "Stock Minimum", 
                    text: "Stock pour couvrir les ventes durant la livraison.", 
                    formula: "Stock Minimum = Consommation moyenne journali√®re &times; D√©lai de livraison moyen en jours" 
                }, 
                securite: { 
                    title: "Stock de S√©curit√©", 
                    text: "Marge pour parer aux impr√©vus (retards, pic de ventes).", 
                    formula: "Calcul√© selon le niveau de risque accept√©." 
                }, 
                alerte: { 
                    title: "Stock d'Alerte", 
                    text: "Niveau de stock qui d√©clenche la commande.", 
                    formula: "Formule : Stock Minimum + Stock de S√©curit√©" 
                } 
            };
            stockLevels.forEach(level => { level.addEventListener('mouseenter', () => { const levelData = explanations[level.dataset.level]; explanationBox.innerHTML = `<div class="text-left"><h4 class="font-bold text-lg text-gray-800">${levelData.title}</h4><p class="mt-2 text-gray-600">${levelData.text}</p><p class="mt-4 font-semibold text-indigo-600 text-sm">${levelData.formula}</p></div>`; }); });

            // --- Simulateur: Point de Commande (PdC) ---
            const pdcState = { jour: 0, stock: 0, ventes: [], alerte: 0, qteCmd: 0, delai: 0, commandeEnCours: false, joursAvantLivraison: 0 };
            const pdcResetBtn = document.getElementById('pdcReset');
            const pdcNextDayBtn = document.getElementById('pdcNextDay');
            const pdcTableBody = document.getElementById('pdcTableBody');
            function resetPdcSim() { pdcState.jour = 0; pdcState.stock = parseInt(document.getElementById('pdcStockInitial').value); pdcState.ventes = document.getElementById('pdcVentes').value.split(',').map(v => parseInt(v.trim()) || 0); pdcState.alerte = parseInt(document.getElementById('pdcStockAlerte').value); pdcState.qteCmd = parseInt(document.getElementById('pdcQteCmd').value); pdcState.delai = parseInt(document.getElementById('pdcDelai').value); pdcState.commandeEnCours = false; pdcState.joursAvantLivraison = 0; pdcTableBody.innerHTML = ''; pdcNextDayBtn.disabled = false; }
            pdcResetBtn.addEventListener('click', resetPdcSim);
            pdcNextDayBtn.addEventListener('click', () => { if (pdcState.jour >= pdcState.ventes.length) { pdcNextDayBtn.disabled = true; return; } const stockDebut = pdcState.stock, venteDuJour = pdcState.ventes[pdcState.jour] || 0; let stockFin = stockDebut - venteDuJour, action = '-', rowClass = ''; if (pdcState.commandeEnCours) { pdcState.joursAvantLivraison--; if (pdcState.joursAvantLivraison <= 0) { stockFin += pdcState.qteCmd; action = `<span class="font-bold text-green-600">Livraison re√ßue</span>`; pdcState.commandeEnCours = false; rowClass = 'bg-green-100'; } } if (!pdcState.commandeEnCours && stockFin <= pdcState.alerte) { action = `<span class="font-bold text-red-600">Commande</span>`; pdcState.commandeEnCours = true; pdcState.joursAvantLivraison = pdcState.delai; rowClass = 'bg-red-100'; } pdcTableBody.innerHTML += `<tr class="${rowClass}"><td class="px-2 py-2 text-center">${pdcState.jour + 1}</td><td class="px-2 py-2 text-center">${stockDebut}</td><td class="px-2 py-2 text-center">${venteDuJour}</td><td class="px-2 py-2 font-semibold text-center">${stockFin}</td><td class="px-2 py-2 text-center">${action}</td></tr>`; pdcState.stock = stockFin; pdcState.jour++; if (pdcState.jour >= pdcState.ventes.length) pdcNextDayBtn.disabled = true; });
            resetPdcSim();

            // --- Simulateur: Gestion Calendaire (Cal) ---
            const calState = { jour: 0, stock: 0, ventes: [], stockSecu: 0, jourCmd: 0, delai: 0, livraisonEnAttente: 0, jourDeLivraison: -1 };
            const calResetBtn = document.getElementById('calReset');
            const calNextDayBtn = document.getElementById('calNextDay');
            const calTableBody = document.getElementById('calTableBody');
            function resetCalSim() { calState.jour = 0; calState.stock = parseInt(document.getElementById('calStockInitial').value); calState.ventes = document.getElementById('calVentes').value.split(',').map(v => parseInt(v.trim()) || 0); calState.stockSecu = parseInt(document.getElementById('calStockSecu').value); calState.jourCmd = parseInt(document.getElementById('calJourCmd').value); calState.delai = parseInt(document.getElementById('calDelai').value); calState.livraisonEnAttente = 0; calState.jourDeLivraison = -1; calTableBody.innerHTML = ''; calNextDayBtn.disabled = false; }
            calResetBtn.addEventListener('click', resetCalSim);
            calNextDayBtn.addEventListener('click', () => { if (calState.jour >= calState.ventes.length) { calNextDayBtn.disabled = true; return; } const stockDebut = calState.stock, venteDuJour = calState.ventes[calState.jour] || 0; let stockFin = stockDebut - venteDuJour, action = '-', rowClass = ''; if (calState.jour + 1 === calState.jourDeLivraison) { stockFin += calState.livraisonEnAttente; action = `<span class="font-bold text-green-600">Livraison (${calState.livraisonEnAttente})</span>`; calState.livraisonEnAttente = 0; calState.jourDeLivraison = -1; rowClass = 'bg-green-100'; } if (calState.jourCmd > 0 && (calState.jour + 1) % calState.jourCmd === 0) { const joursACouvrir = calState.delai + calState.jourCmd; const ventesFutures = calState.ventes.slice(calState.jour + 1, calState.jour + 1 + joursACouvrir).reduce((a, b) => a + b, 0); const stockCible = ventesFutures + calState.stockSecu; const qteACommander = Math.max(0, stockCible - (stockFin + calState.livraisonEnAttente)); action = `<span class="font-bold text-blue-600">Cmd: ${qteACommander}</span>`; calState.livraisonEnAttente = qteACommander; calState.jourDeLivraison = calState.jour + 1 + calState.delai; rowClass = 'bg-blue-100'; } calTableBody.innerHTML += `<tr class="${rowClass}"><td class="px-2 py-2 text-center">${calState.jour + 1}</td><td class="px-2 py-2 text-center">${stockDebut}</td><td class="px-2 py-2 text-center">${venteDuJour}</td><td class="px-2 py-2 font-semibold text-center">${stockFin}</td><td class="px-2 py-2 text-center">${action}</td></tr>`; calState.stock = stockFin; calState.jour++; if (calState.jour >= calState.ventes.length) calNextDayBtn.disabled = true; });
            resetCalSim();

            // --- Simulateur: Arbitrage ---
            const calculateArbitrageBtn = document.getElementById('calculateArbitrage');
            function runArbitrage() { const C = parseFloat(document.getElementById('arbBesoin').value), T = parseFloat(document.getElementById('arbTaux').value) / 100, P = parseFloat(document.getElementById('arbCout').value); const tableBody = document.getElementById('arbitrageTable'), analysisResult = document.getElementById('analysisResult'); if (isNaN(C) || isNaN(T) || isNaN(P) || !tableBody) return; tableBody.innerHTML = ''; let minCost = Infinity, bestN = 0; for (let n = 1; n <= 10; n++) { const coutTotal = (C / (2 * n)) * T + (n * P); if (coutTotal < minCost) { minCost = coutTotal; bestN = n; } } for (let n = 1; n <= 10; n++) { const coutPossession = (C / (2 * n)) * T, coutPassation = n * P, coutTotal = coutPossession + coutPassation; const isOptimal = n === bestN; const rowClass = isOptimal ? 'bg-green-100 font-bold' : ''; tableBody.innerHTML += `<tr class="${rowClass}"><td class="px-4 py-2">${n}</td><td class="px-4 py-2">${coutPossession.toFixed(2)} ‚Ç¨</td><td class="px-4 py-2">${coutPassation.toFixed(2)} ‚Ç¨</td><td class="px-4 py-2 text-gray-800">${coutTotal.toFixed(2)} ‚Ç¨ ${isOptimal ? '&#9733;' : ''}</td></tr>`; } analysisResult.innerHTML = `<strong>Analyse du Manager :</strong> Le sc√©nario le plus √©conomique est de passer <strong>${bestN} commandes</strong>, pour un co√ªt total optimis√© de <strong>${minCost.toFixed(2)} ‚Ç¨</strong>.`; analysisResult.style.display = 'block'; };
            calculateArbitrageBtn.addEventListener('click', runArbitrage);
            runArbitrage();

            // --- Logique du Quiz ---
            const quizData = [
                {
                    question: "Un gestionnaire qui d√©cide de passer de tr√®s nombreuses petites commandes pour minimiser son stock moyen parviendra √† r√©duire son co√ªt de gestion global, car le co√ªt de possession sera presque nul.",
                    type: "tf",
                    options: ["Vrai", "Faux"],
                    answer: "Faux",
                    hint: 'Pensez √† la nature "antagoniste" des deux co√ªts principaux. Que se passe-t-il pour le co√ªt de passation lorsque le nombre de commandes augmente ?',
                    feedback: {
                        correct: "Exact. Votre raisonnement est correct. Bien que les co√ªts de possession diminuent, la multiplication des commandes fait exploser les co√ªts de passation (frais administratifs, transport, etc.). Le co√ªt de gestion total, qui est la somme des deux, augmentera donc fortement.",
                        incorrect: "Attention au caract√®re antagoniste des co√ªts. Le co√ªt de gestion des approvisionnements est la somme du co√ªt de possession ET du co√ªt de passation. En passant de tr√®s nombreuses commandes, le co√ªt de passation total (Co√ªt par commande √ó Nombre de commandes) devient tr√®s √©lev√© et annule, voire d√©passe, le gain r√©alis√© sur le co√ªt de possession."
                    }
                },
                {
                    question: "Le magasin Avicenne paie un loyer pour son entrep√¥t, emploie un magasinier et souscrit une assurance contre le vol et la d√©t√©rioration de ses marchandises. Ces charges font principalement partie de quel co√ªt ?",
                    type: "mcq",
                    options: ["Le co√ªt de passation des commandes", "Le co√ªt de gestion des approvisionnements", "Le co√ªt de possession du stock", "Le co√ªt d'opportunit√© du capital immobilis√©"],
                    answer: "Le co√ªt de possession du stock",
                    hint: "Ce co√ªt regroupe toutes les d√©penses li√©es au fait de d√©tenir physiquement et financi√®rement du stock.",
                    feedback: {
                        correct: "Parfait. Le co√ªt de possession regroupe bien tous les frais li√©s √† la d√©tention des marchandises : frais de magasinage (loyer, personnel), frais financiers (capital immobilis√©) et frais de d√©pr√©ciation (risques).",
                        incorrect: "Il est important de bien distinguer les deux types de co√ªts. Le co√ªt de passation (a) est li√© au processus d'achat. Le co√ªt de gestion (b) est le total des deux. Le co√ªt d'opportunit√© (d) n'est qu'une des composantes du co√ªt de possession. Les charges d√©crites (loyer, assurance, personnel de stockage) sont directement li√©es au fait de d√©tenir du stock."
                    }
                },
                {
                    question: "Le service achat du magasin Avicenne passe une journ√©e √† contacter des fournisseurs, √† remplir des bons de commande et √† organiser le transport pour un r√©approvisionnement. Les salaires de ce personnel et les frais de livraison sont inclus dans :",
                    type: "mcq",
                    options: ["Le co√ªt de possession du stock", "Le co√ªt de passation des commandes", "Le stock de s√©curit√©", "Le taux de possession"],
                    answer: "Le co√ªt de passation des commandes",
                    hint: "Ce co√ªt est li√© √† l'action de commander elle-m√™me, ind√©pendamment de la quantit√©.",
                    feedback: {
                        correct: "Excellent. Le co√ªt de passation des commandes couvre pr√©cis√©ment les charges administratives (salaires du service achat) et logistiques (transport, r√©ception) g√©n√©r√©es par le processus d'achat lui-m√™me.",
                        incorrect: "Le co√ªt de possession (a) concerne les charges li√©es au stockage des marchandises une fois qu'elles sont dans l'entrep√¥t. Ici, les co√ªts sont engag√©s pour faire venir la marchandise. Il s'agit donc bien du co√ªt de passation."
                    }
                },
                {
                    question: "La formule de Wilson est un outil universel qui permet de calculer la quantit√© optimale √† commander pour n'importe quel produit, qu'il s'agisse de sel, dont la demande est tr√®s stable, ou de maillots de bain, dont la demande est tr√®s saisonni√®re.",
                    type: "tf",
                    options: ["Vrai", "Faux"],
                    answer: "Faux",
                    hint: 'Quelle est la condition d\'application "essentielle" et "stricte" de ce mod√®le math√©matique ?',
                    feedback: {
                        correct: "Tr√®s bien. Vous avez parfaitement identifi√© la limite principale de cet outil. La formule de Wilson n'est pertinente et efficace que lorsque la demande pour un produit est certaine, constante et r√©guli√®re. L'appliquer √† une demande volatile comme celle des maillots de bain conduirait √† du surstockage ou des ruptures.",
                        incorrect: "Attention, la formule de Wilson est un outil puissant mais tr√®s sp√©cifique. L'une de ses hypoth√®ses fondamentales est que la demande est connue et stable. Pour des produits √† demande irr√©guli√®re ou saisonni√®re, il faut utiliser d'autres m√©thodes comme le point de commande ou la gestion calendaire."
                    }
                },
                {
                    question: "En appliquant la formule de Wilson, un gestionnaire cherche avant tout √† d√©terminer :",
                    type: "mcq",
                    options: ["Le niveau du stock de s√©curit√© pour √©viter les ruptures.", "La cadence d'approvisionnement qui rendra le co√ªt total de gestion des stocks le plus bas possible.", "La quantit√© √† commander lorsque la demande est tr√®s irr√©guli√®re.", "Le meilleur prix d'achat unitaire aupr√®s des fournisseurs."],
                    answer: "La cadence d'approvisionnement qui rendra le co√ªt total de gestion des stocks le plus bas possible.",
                    hint: "L'objectif de la formule est de trouver un point d'√©quilibre √©conomique entre deux forces oppos√©es.",
                    feedback: {
                        correct: "C'est exact. L'objectif unique de la formule de Wilson est de trouver le point d'√©quilibre √©conomique, c'est-√†-dire le nombre de commandes (et donc la quantit√© par commande) qui minimise la somme des co√ªts de possession et de passation.",
                        incorrect: "Le stock de s√©curit√© (a) et la gestion de la demande irr√©guli√®re (c) sont trait√©s par d'autres m√©thodes. Le prix d'achat (d) est une donn√©e d'entr√©e de la formule, mais pas son r√©sultat. La formule de Wilson se concentre exclusivement sur la minimisation du co√ªt total de gestion du stock."
                    }
                },
                {
                    question: "Le syst√®me de gestion du magasin Avicenne indique que le stock de riz vient d'atteindre 105 unit√©s, ce qui d√©clenche automatiquement l'envoi d'un bon de commande au fournisseur. Ce niveau de 105 unit√©s repr√©sente :",
                    type: "mcq",
                    options: ["Le stock minimum", "Le stock de s√©curit√©", "Le stock d'alerte (ou point de commande)", "Le stock moyen"],
                    answer: "Le stock d'alerte (ou point de commande)",
                    hint: 'Ce seuil est un "signal op√©rationnel" calcul√© pour agir avant de devoir utiliser les r√©serves.',
                    feedback: {
                        correct: "Parfait. Le stock d'alerte est pr√©cis√©ment le niveau de stock qui, une fois atteint, d√©clenche l'action de passer une nouvelle commande. Il est calcul√© pour que la livraison arrive avant que le stock de s√©curit√© ne soit entam√©.",
                        incorrect: "Le stock minimum (a) couvre les besoins pendant la livraison et le stock de s√©curit√© (b) couvre les impr√©vus. Le stock d'alerte est la somme des deux et sert de d√©clencheur. C'est le \"voyant sur le tableau de bord\" qui indique qu'il est temps de commander."
                    }
                },
                {
                    question: "Lorsque le co√ªt de gestion des approvisionnements est √† son point le plus bas (l'optimum de Wilson), c'est parce que le co√ªt de possession du stock et le co√ªt de passation des commandes sont les plus proches l'un de l'autre.",
                    type: "tf",
                    options: ["Vrai", "Faux"],
                    answer: "Vrai",
                    hint: "Observez le tableau de simulation de l'exemple de la farine. Que remarquez-vous sur les valeurs des deux co√ªts lorsque le co√ªt total est minimal ?",
                    feedback: {
                        correct: "Tout √† fait. C'est une caract√©ristique fondamentale du mod√®le de Wilson. L'optimum est trouv√© au point d'intersection des deux courbes de co√ªt. Dans les simulations, on observe que le co√ªt total est minimal lorsque le co√ªt de possession et le co√ªt de passation sont les plus proches en valeur.",
                        incorrect: "Revoyez les tableaux de simulation. Vous constaterez que lorsque le nombre de commandes est tr√®s faible (co√ªt de passation bas, co√ªt de possession √©lev√©) ou tr√®s √©lev√© (co√ªt de passation √©lev√©, co√ªt de possession bas), l'√©cart entre les deux co√ªts est immense et le co√ªt total est √©lev√©. Le minimum est atteint lorsque ces deux forces contraires s'√©quilibrent."
                    }
                },
                {
                    question: "Un client fid√®le du magasin Avicenne ne trouve pas sa farine habituelle en rayon. Frustr√©, il se rend chez un concurrent, y fait toutes ses courses et publie un avis n√©gatif en ligne. Cet √©v√©nement illustre principalement :",
                    type: "mcq",
                    options: ["Un probl√®me li√© au co√ªt de passation des commandes.", "Les co√ªts directs et indirects d'une rupture de stock.", "Les contraintes d'un approvisionnement en grande quantit√©.", "Une erreur dans le calcul du stock moyen."],
                    answer: "Les co√ªts directs et indirects d'une rupture de stock.",
                    hint: "Les cons√©quences d'un stock vide d√©passent largement la simple vente manqu√©e.",
                    feedback: {
                        correct: "Excellente analyse. Vous avez bien identifi√© que la rupture de stock a des cons√©quences multiples : la perte de la vente (co√ªt direct), mais aussi et surtout la perte du client et la d√©gradation de l'image de marque (co√ªts indirects), qui sont souvent bien plus graves √† long terme.",
                        incorrect: "Une rupture de stock est un √©chec op√©rationnel majeur. La situation d√©crite va bien au-del√† d'un simple probl√®me de co√ªt (a) ou de contrainte de stockage (c). Elle montre la \"boucle de r√©troaction n√©gative\" : vente perdue -> client insatisfait -> perte de fid√©lit√© -> mauvaise publicit√©."
                    }
                },
                {
                    question: "Le fournisseur de riz du magasin Avicenne impose des jours de livraison fixes : il ne passe que le mardi et le jeudi. Pour g√©rer son stock de riz, dont la demande est volatile, le magasin doit donc utiliser :",
                    type: "mcq",
                    options: ["La formule de Wilson", "La m√©thode du point de commande", "La m√©thode de la gestion calendaire", "Une strat√©gie d'approvisionnement en grande quantit√©"],
                    answer: "La m√©thode de la gestion calendaire",
                    hint: 'L\'une des m√©thodes est bas√©e sur le principe "Date Fixe, Quantit√© Variable".',
                    feedback: {
                        correct: "C'est la bonne r√©ponse. La gestion calendaire est sp√©cifiquement con√ßue pour les situations o√π le fournisseur impose des dates de livraison fixes. Les commandes sont pass√©es √† intervalle r√©gulier, et seule la quantit√© command√©e varie en fonction des besoins.",
                        incorrect: "La formule de Wilson (a) ne s'applique pas car la demande est volatile. La m√©thode du point de commande (b) est utilis√©e quand la quantit√© est fixe, pas la date. Ici, la contrainte porte sur le calendrier, d'o√π le nom 'gestion calendaire'."
                    }
                },
                {
                    question: "Pour un autre produit, le fournisseur impose de commander par palettes compl√®tes de 200 unit√©s. Les ventes √©tant irr√©guli√®res, la commande est d√©clench√©e √† des dates diff√©rentes, chaque fois que le stock devient bas. Cette m√©thode s'appelle :",
                    type: "mcq",
                    options: ["La gestion calendaire", "La formule de Wilson", "La m√©thode du point de commande", "Le calcul du stock minimum"],
                    answer: "La m√©thode du point de commande",
                    hint: 'Cette m√©thode suit le principe "Quantit√© Fixe, Date Variable".',
                    feedback: {
                        correct: "Exact. La m√©thode du point de commande est la bonne strat√©gie lorsque le fournisseur impose une quantit√© fixe. La commande est d√©clench√©e √† une date variable, d√®s que le stock atteint le seuil d'alerte (le point de commande).",
                        incorrect: "La gestion calendaire (a) est utilis√©e quand la date de livraison est fixe. La formule de Wilson (b) s'applique √† une demande r√©guli√®re. Ici, la contrainte porte sur la quantit√©, et la commande est d√©clench√©e par un niveau de stock, ce qui est le principe m√™me du point de commande."
                    }
                },
                {
                    question: "Le stock de s√©curit√© est le stock pr√©vu pour couvrir la consommation normale pendant le d√©lai de livraison du fournisseur. Il est donc consomm√© et renouvel√© √† chaque cycle de commande.",
                    type: "tf",
                    options: ["Vrai", "Faux"],
                    answer: "Faux",
                    hint: "Pensez √† la m√©taphore du r√©servoir de carburant d'une voiture. Le stock de s√©curit√© est-il le carburant normal ou la r√©serve d'urgence ?",
                    feedback: {
                        correct: "Tr√®s bien, vous avez bien fait la distinction. Le stock de s√©curit√© est un \"tampon\" additionnel pour se prot√©ger contre les impr√©vus (retard de livraison, pic de ventes). Le stock qui couvre la consommation normale pendant le d√©lai de livraison est le \"stock minimum\". Le stock de s√©curit√© ne doit, en th√©orie, jamais √™tre utilis√©.",
                        incorrect: "Attention √† ne pas confondre les deux. Le \"stock minimum\" est celui qui est consomm√© pendant que vous attendez la livraison. Le \"stock de s√©curit√©\" est une r√©serve suppl√©mentaire pour faire face aux al√©as. C'est une assurance contre l'impr√©vu qui doit rester intacte en temps normal."
                    }
                },
                {
                    question: "Le magasin Avicenne a une consommation annuelle de 12 000 kg de farine √† 1‚Ç¨/kg, un co√ªt de passation de 15‚Ç¨ et un taux de possession de 10%. En utilisant la formule de Wilson, quel est le nombre optimal de commandes √† passer ?",
                    type: "mcq",
                    options: ["Environ 4 commandes", "Environ 10 commandes", "Environ 6 commandes", "Environ 2 commandes"],
                    answer: "Environ 6 commandes",
                    hint: "Appliquez le calcul : N = ‚àö(Consommation en valeur √ó Taux de possession / (2 √ó Co√ªt de passation)) soit ‚àö(12000 √ó 0,10 / (2 √ó 15)).",
                    feedback: {
                        correct: "Excellent calcul. N = ‚àö(12000 √ó 1 √ó 0,10 / (2 √ó 15)) = ‚àö(1200 / 30) = ‚àö40 ‚âà 6,32. On arrondit au nombre entier le plus proche, soit 6 commandes par an.",
                        incorrect: "Le calcul est le suivant : le num√©rateur est (12000 √ó 1 √ó 0,10) = 1200. Le d√©nominateur est (2 √ó 15) = 30. Le ratio est donc 1200 / 30 = 40. La racine carr√©e de 40 est approximativement 6,32. Le nombre optimal de commandes est donc 6."
                    }
                }
            ];
            let currentQuestionIndex = 0; let score = 0; let userAnswers = [];
            const quizContainer = document.getElementById('quiz-container'); const resultsContainer = document.getElementById('quiz-results-area'); const questionEl = document.getElementById('quiz-question'); const optionsEl = document.getElementById('quiz-options'); const hintBtn = document.getElementById('quiz-hint-btn'); const hintText = document.getElementById('quiz-hint-text'); const feedbackEl = document.getElementById('quiz-feedback'); const nextBtn = document.getElementById('quiz-next-btn'); const progressBar = document.getElementById('quiz-progress-bar'); const progressText = document.getElementById('quiz-progress-text');
            function startQuiz() { currentQuestionIndex = 0; score = 0; userAnswers = []; quizContainer.style.display = 'block'; resultsContainer.style.display = 'none'; showQuestion(); }
            function showQuestion() { resetState(); const question = quizData[currentQuestionIndex]; questionEl.textContent = question.question; question.options.forEach(option => { const button = document.createElement('button'); button.textContent = option; button.classList.add('quiz-option'); button.addEventListener('click', () => selectAnswer(button, option)); optionsEl.appendChild(button); }); updateProgress(); }
            function resetState() { optionsEl.innerHTML = ''; feedbackEl.innerHTML = ''; feedbackEl.style.display = 'none'; hintText.style.display = 'none'; hintBtn.style.display = 'block'; nextBtn.style.display = 'none'; }
            function selectAnswer(button, selectedOption) { const question = quizData[currentQuestionIndex]; const isCorrect = selectedOption === question.answer; userAnswers[currentQuestionIndex] = { question: question.question, selected: selectedOption, correct: question.answer, isCorrect: isCorrect }; if (isCorrect) { score++; button.classList.add('correct'); feedbackEl.innerHTML = `<div class="feedback-box correct"><p class="font-semibold">Bonne r√©ponse !</p><p class="text-sm">${question.feedback.correct}</p></div>`; } else { button.classList.add('incorrect'); feedbackEl.innerHTML = `<div class="feedback-box incorrect"><p class="font-semibold">Mauvaise r√©ponse</p><p class="text-sm">${question.feedback.incorrect}</p></div>`; Array.from(optionsEl.children).forEach(btn => { if (btn.textContent === question.answer) { btn.classList.add('correct'); } }); } feedbackEl.style.display = 'block'; Array.from(optionsEl.children).forEach(btn => btn.disabled = true); nextBtn.style.display = 'inline-block'; hintBtn.style.display = 'none'; hintText.style.display = 'none'; }
            function updateProgress() { const progress = ((currentQuestionIndex) / quizData.length) * 100; progressBar.style.width = `${progress}%`; progressText.textContent = `Question ${currentQuestionIndex + 1} / ${quizData.length}`; }
            hintBtn.addEventListener('click', () => { hintText.textContent = quizData[currentQuestionIndex].hint; hintText.style.display = 'block'; hintBtn.style.display = 'none'; });
            nextBtn.addEventListener('click', () => { currentQuestionIndex++; if (currentQuestionIndex < quizData.length) { showQuestion(); } else { showResults(); } });
            function showResults() { quizContainer.style.display = 'none'; resultsContainer.style.display = 'block'; const percentage = Math.round((score / quizData.length) * 100); const scoreEl = document.getElementById('quiz-score'); const verdictEl = document.getElementById('quiz-verdict'); const resultMessageEl = document.getElementById('quiz-result-message'); scoreEl.textContent = `${percentage}%`; if (percentage >= 75) { verdictEl.textContent = "Bravo ! Vous ma√Ætrisez les concepts cl√©s !"; resultMessageEl.classList.add('bg-green-100', 'text-green-800'); resultMessageEl.classList.remove('bg-orange-100', 'text-orange-800'); } else { verdictEl.textContent = "Bon effort ! N'h√©sitez pas √† revoir les sections pour renforcer vos connaissances."; resultMessageEl.classList.add('bg-orange-100', 'text-orange-800'); resultMessageEl.classList.remove('bg-green-100', 'text-green-800'); } const summaryEl = document.getElementById('quiz-summary'); summaryEl.innerHTML = ''; userAnswers.forEach((ans, index) => { const icon = ans.isCorrect ? '‚úÖ' : '‚ùå'; const selectedClass = ans.isCorrect ? '' : 'text-red-600 line-through'; const correctDisplay = ans.isCorrect ? '' : `<p class="text-sm text-green-700">La bonne r√©ponse √©tait : ${ans.correct}</p>`; summaryEl.innerHTML += `<div class="border p-3 rounded-md"><p class="font-medium">${index + 1}. ${ans.question}</p><p class="text-sm mt-1">Votre r√©ponse : <span class="${selectedClass}">${icon} ${ans.selected}</span></p>${correctDisplay}</div>`; }); }
            document.getElementById('quiz-restart-btn').addEventListener('click', startQuiz);
            startQuiz();

            // --- Bouton Retour en Haut ---
            const backToTopBtn = document.getElementById('back-to-top-btn');
            if (backToTopBtn) {
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 400) {
                        backToTopBtn.classList.remove('opacity-0', 'invisible');
                        backToTopBtn.classList.add('opacity-100', 'visible');
                    } else {
                        backToTopBtn.classList.remove('opacity-100', 'visible');
                        backToTopBtn.classList.add('opacity-0', 'invisible');
                    }
                });
            }
        });
    </script>
</body>
</html>